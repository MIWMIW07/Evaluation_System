# .htaccess file for /reports directory
# This file should be placed in the /reports folder to enable directory browsing

# Enable directory browsing and symlink following
Options +Indexes +FollowSymLinks
AllowOverride All

# Set index files priority
DirectoryIndex index.html

# Allow access to all users
Order allow,deny
Allow from all

# Allow access to HTML and CSV files
<Files "*.html">
    Order allow,deny
    Allow from all
    Header set Content-Type "text/html; charset=UTF-8"
</Files>

<Files "*.csv">
    Order allow,deny
    Allow from all
    Header set Content-Type "text/csv; charset=UTF-8"
    Header set Content-Disposition "inline"
</Files>

# Prevent access to PHP files in reports directory for security
<Files "*.php">
    Order allow,deny
    Deny from all
</Files>

# Prevent access to .htaccess files
<Files ".htaccess">
    Order allow,deny
    Deny from all
</Files>

# Custom styling for directory listings
IndexOptions FancyIndexing HTMLTable SuppressDescription NameWidth=50 DescriptionWidth=20 SuppressLastModified SuppressSize

# Custom index styling
IndexStyleSheet "https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"

# Add custom icons for different file types
AddIcon /icons/html.png .html
AddIcon /icons/csv.png .csv
AddIcon /icons/folder.png ^^DIRECTORY^^

# Security headers for reports
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options SAMEORIGIN
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Cache-Control "public, max-age=3600"
    Header always set Referrer-Policy "same-origin"
</IfModule>

# Enable compression for HTML and CSV files
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/csv
    AddOutputFilterByType DEFLATE text/plain
</IfModule>

# Set proper MIME types
<IfModule mod_mime.c>
    AddType text/html .html
    AddType text/csv .csv
</IfModule>

# Prevent direct access to sensitive files that might be generated
<FilesMatch "\.(bak|backup|old|tmp|log)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Custom error pages for this directory
ErrorDocument 403 "<html><body><h1>Access Denied</h1><p>You don't have permission to access this report.</p><p><a href='/admin.php'>← Back to Admin Dashboard</a></p></body></html>"
ErrorDocument 404 "<html><body><h1>Report Not Found</h1><p>The requested evaluation report was not found.</p><p><a href='/reports/'>← Back to Reports Index</a></p></body></html>"
